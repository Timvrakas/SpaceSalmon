//AUTOGENERATED! DO NOT EDIT!

#pragma once
#include <stdint.h>
#include "{{path}}"

struct {{slate}}_t
{
    {% for id,channel in channels.items() %}
    SlateField<{{ channel.type }}> {{ id }} = {{ channel.default }}; // {{channel.desc}}, in {{channel.unit}}
    {% endfor %}

    typedef struct { uint8_t payload[{{total_len}}]; } {{slate}}_pkt_t;

    void seralize(telemetry_pkt_t &pkt){
        seralize_field(pkt,metaslate_hash,0);
        {% for id,channel in channels.items() %}
        seralize_field(pkt,{{ id }},{{channel.offset}});
        {% endfor %}
    }

    void parseCMD(cmd_pkt_t &pkt){
        if(pkt.slate_hash == metaslate_hash){
            switch (pkt.offset)
            {
            {% for id,channel in channels.items() if channel.mutable %}
            case {{channel.offset}}:
                {{id}} = *({{channel.type}}*)pkt.data;
                break;
            {% endfor %}
            default:
                break;
            }
        }
    }

    static constexpr uint8_t metaslate_blob[] = { {{metaslate_blob}} };
    static constexpr uint64_t metaslate_hash = {{metaslate_hash}};
};

